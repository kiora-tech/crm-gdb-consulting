<div class="pagetitle">
    <h1>{{ "menu.customer"|trans }}</h1>
</div>

<section class="section">
    <div>
        {{ form_start(form, {'attr': {'class': 'needs-validation', 'novalidate': 'novalidate'}}) }}
        <div class="card-body">
            <!-- DÃ©but du formulaire -->

            <div class="row">
                <!-- Champ pour le nom -->
                <div class="col-md-6 mb-3">
                    {{ form_label(form.name, null, {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.name, {'attr': {'class': 'form-control', 'placeholder': 'Enter customer name'}}) }}
                    {{ form_errors(form.name) }}
                </div>

                <!-- Champ pour L'origine du lead -->
                <div class="col-md-6 mb-3">
                    {{ form_label(form.leadOrigin, null, {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.leadOrigin, {'attr': {'class': 'form-control', 'placeholder': 'Enter lead origin'}}) }}
                    {{ form_errors(form.leadOrigin) }}
                </div>

                <div class="col-md-6 mb-3">
                    {{ form_label(form.action, null, {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.action, {'attr': {'class': 'form-control', 'placeholder': 'Action a mener'}}) }}
                    {{ form_errors(form.action) }}
                </div>

                <!-- Champ pour L'origine du lead -->
                <div class="col-md-6 mb-3">
                    {{ form_label(form.worth, null, {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.worth, {'attr': {'class': 'form-control', 'placeholder': 'Valeur du contrat'}}) }}
                    {{ form_errors(form.worth) }}
                </div>

                <div class="col-md-6 mb-3">
                    {{ form_label(form.commision, null, {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.commision, {'attr': {'class': 'form-control', 'placeholder': 'Commission du commercial'}}) }}
                    {{ form_errors(form.commision) }}
                </div>

                <div class="col-md-3 mb-3">
                    {{ form_label(form.origin, null, {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.origin, {'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.origin) }}
                </div>
                <div class="col-md-3 mb-3">
                    {{ form_label(form.status, null, {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.status, {'attr': {'class': 'form-control'}}) }}
                    {{ form_errors(form.status) }}
                </div>
            </div>

            <div class="col-md-6 mb-3">
                {{ form_label(form.margin, null, {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(form.margin, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.margin) }}
            </div>

            <div class="col-md-6 mb-3">
                {{ form_label(form.companyGroup, null, {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(form.companyGroup, {'attr': {'class': 'form-control'}}) }}
                {{ form_errors(form.companyGroup) }}
            </div>
        </div>

        <!-- Gestion des Business Entities et Contacts en deux colonnes -->
        <div class="row">
            <div class="col-md-6 mb-4">
                <h3>{{ 'customer.business_entities'|trans }}</h3>
                <div data-controller="form-collection"
                     data-form-collection-index-value="{{ form.businessEntities|length }}"
                     data-form-collection-template-value="{{ form_widget(form.businessEntities.vars.prototype)|e('html_attr') }}">
                    <div data-form-collection-target="container">
                        {% for businessEntityForm in form.businessEntities %}
                            <div class="form-item mb-3 p-3 rounded">
                                {{ form_row(businessEntityForm, {'attr': {'class': 'mb-3'}}) }}
                                <button type="button" class="btn btn-danger mt-2"
                                        data-action="form-collection#removeItem">{{ 'button.delete'|trans }}</button>
                            </div>
                        {% else %}
                            {{ form(form.businessEntities) }}
                        {% endfor %}
                    </div>
                    <button type="button" class="btn btn-light mt-3" data-action="form-collection#addItem">
                        {{ 'customer.add_business_entity'|trans }}
                    </button>
                </div>
            </div>

            <!-- Gestion des Energies et Prospects en deux colonnes -->
            <div class="row">
                <div class="col-md-6 mb-4">
                    <h3>{{ 'customer.energies'|trans }}</h3>
                    <div data-controller="form-collection" data-form-collection-index-value="{{ form.energies|length }}"
                         data-form-collection-template-value="{{ form_widget(form.energies.vars.prototype)|e('html_attr') }}">
                        <div data-form-collection-target="container">
                            {% for energyForm in form.energies %}
                                <div class="form-item mb-3 p-3 rounded">
                                    {{ form_row(energyForm, {'attr': {'class': 'mb-3'}}) }}
                                    <button type="button" class="btn btn-danger mt-2"
                                            data-action="form-collection#removeItem">{{ 'button.delete'|trans }}</button>
                                </div>
                            {% else %}
                                {{ form(form.energies) }}{% endfor %}
                        </div>
                        <button type="button" class="btn btn-light mt-3" data-action="form-collection#addItem">
                            {{ 'customer.add_energy'|trans }}</button>
                    </div>
                </div>

            </div>


            <div style="display:flex;gap:5px;">
                {{ form_row(form._token) }}
                <button class="btn btn-primary mt-4">{{ "button.save"|trans }}</button>
                <a class="btn btn-secondary mt-4" href="{{ path('app_customer_index') }}">{{ "button.back"|trans }}</a>
            </div>
        </div>
        {{ form_end(form) }}
    </div>
</section>
